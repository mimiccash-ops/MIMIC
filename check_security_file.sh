#!/bin/bash
# Check security.py file on server

echo "üîç –ü–µ—Ä–µ–≤—ñ—Ä—è—é —Ñ–∞–π–ª security.py –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ..."
echo ""

cd /var/www/mimic || exit 1

# 1. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤—ñ–¥—Å—Ç—É–ø–∏ –≤ —Ñ–∞–π–ª—ñ
echo "üìã –í—ñ–¥—Å—Ç—É–ø–∏ –≤ security.py (—Ä—è–¥–∫–∏ 628-635):"
sed -n '628,635p' security.py | cat -A
echo ""

# 2. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ —î –∑–º—ñ—à–∞–Ω—ñ —Ç–∞–±—É–ª—è—Ü—ñ—ó —Ç–∞ –ø—Ä–æ–±—ñ–ª–∏
echo "üìã –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ –∑–º—ñ—à–∞–Ω—ñ —Ç–∞–±—É–ª—è—Ü—ñ—ó —Ç–∞ –ø—Ä–æ–±—ñ–ª–∏:"
sed -n '628,635p' security.py | grep -P '\t' && echo "  ‚ö†Ô∏è –ó–Ω–∞–π–¥–µ–Ω–æ —Ç–∞–±—É–ª—è—Ü—ñ—ó!" || echo "  ‚úÖ –¢—ñ–ª—å–∫–∏ –ø—Ä–æ–±—ñ–ª–∏"
echo ""

# 3. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ç–æ—á–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–æ–±—ñ–ª—ñ–≤ –Ω–∞ —Ä—è–¥–∫—É 630
echo "üìã –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–æ–±—ñ–ª—ñ–≤ –Ω–∞ –ø–æ—á–∞—Ç–∫—É —Ä—è–¥–∫–∞ 630:"
sed -n '630p' security.py | sed 's/^\( *\).*/\1/' | wc -c
echo ""

# 4. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ Python —Å–∏–Ω—Ç–∞–∫—Å–∏—Å
echo "üìã –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ Python —Å–∏–Ω—Ç–∞–∫—Å–∏—Å—É:"
python3 -m py_compile security.py 2>&1 && echo "  ‚úÖ –°–∏–Ω—Ç–∞–∫—Å–∏—Å OK" || echo "  ‚ùå –ü–æ–º–∏–ª–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å—É!"
echo ""

# 5. –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ —ñ–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ security
echo "üìã –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —ñ–º–ø–æ—Ä—Ç—É security:"
python3 -c "import security; print('‚úÖ security —ñ–º–ø–æ—Ä—Ç—É—î—Ç—å—Å—è —É—Å–ø—ñ—à–Ω–æ')" 2>&1 || echo "  ‚ùå –ü–æ–º–∏–ª–∫–∞ —ñ–º–ø–æ—Ä—Ç—É security!"
echo ""

echo "‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!"
